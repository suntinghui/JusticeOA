<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>顺义司法局移动办公平台</title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="../css/mui.min.css" rel="stylesheet" />

		<style>
			.content-div {
				background-color: #008FF7;
				padding: 5%;
				position: absolute;
				top: 10%;
			}
			
			#userNameText {
				margin-top: 40px;
			}
			
			#passwordText {
				margin-top: 10px;
			}
			
			#loginBtn {
				background-color: orange;
				margin-top: 30px;
				padding-top: 10px;
				padding-bottom: 10px;
				font-size: 17px;
			}
		</style>

	</head>

	<body style="background-color: #008FF7;">
		<!--所有的页面程序必须写在该div里-->
		<div class="mui-content">
			<div class="content-div">
				<h1 style="text-align: center; color: #FFFFFF; ">顺义司法局</h1>
				<h3 style="text-align: center;color: #FFFFFF;margin-top: 18px;">移动办公平台</h3>

				<input type="text" id="userNameText" placeholder="请输入用户名" value="zhouxiaomin" />

				<input type="password" id="passwordText" placeholder="请输入密码" value="aaaaaa" />

				<button id='loginBtn' class="mui-btn mui-btn-block mui-btn-primary">登&nbsp;&nbsp;&nbsp;录</button>

			</div>
		</div>

		<script src="../js/mui.min.js"></script>
		<script src="../js/constants.js" type="text/javascript" charset="utf-8"></script>

		<script type="text/javascript">
			var userNameText = document.getElementById("userNameText");
			var passwordText = document.getElementById("passwordText");
			var loginBtn = document.getElementById("loginBtn");

			loginBtn.addEventListener("tap", function(event) {
				if(checkInput()) {
					loginReq();
				}
			}, false);

			mui.init();

			(function($, doc) {
				$.plusReady(function() {

				});
			}(mui, document));

			var checkInput = function() {
				if(userNameText.value.length == 0) {
					mui.toast("请输入用户名");
					return false;
				}

				if(passwordText.value.length == 0) {
					mui.toast("请输入密码");
					return false;
				}

				return true;
			}

			var loginReq = function() {
				var argus = "&loginName=" + userNameText.value + "&loginPwd=" + passwordText.value + "&deviceId=" + "123456";
				var url = HOST + "Identity.ashx?Commond=AppLogin" + argus;
				mui.getJSON(url, {}, function(resp) {
					console.log('登录响应：' + JSON.stringify(resp));

					switch(resp.LoginResult - 0) {
						case 0:
							// 保存用户信息
							window.localStorage.setItem(TokenKey, resp.TokenKey);

							mui.openWindow({
								url: 'catalog.html',
								id: 'catalog',
								preload: true,
								show: {
									aniShow: 'pop-in'
								},
							});
							break;

						case 1:
							mui.toast("账户不存在");
							break;
							break;

						case 2:
							mui.toast("密码错误");
							break;

						case 3:
							mui.toast("没有移动办公权限");
							break;

						case 4:
							mui.toast("无效的移动端设备");
							break;

						case 5:
							mui.toast("设备与账号不匹配");
							break;

						case 6:
							mui.toast("该设备已被禁用");
							break;

						default:
							mui.toast("登录失败，未知异常");
							break;
					}
				});
			};
		</script>

	</body>

</html>